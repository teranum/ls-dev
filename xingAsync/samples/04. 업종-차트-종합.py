# -*- coding: euc-kr -*-
from xingAsync import *
from common import *
from app_key import user_id, user_pwd, cert_pwd # app_key.py 파일에 사용자 ID, 비번, 공증 비번을 저장해두고 import

async def sample(api: XingApi):
    if not await api.login(user_id, user_pwd, cert_pwd):
        return print(f"로그인 실패: {api.last_message}")

    inputs = {
        "shcode": "001",    # 업종코드 (001: 종합...)
        "gubun": '1',       # 주기구분 (0:틱1:분2:일3:주4:월)
        "ncnt": 100,        # 틱개수
        "qrycnt": 100,      # 조회건수 (1 이상 500 이하값만 유효)
        "tdgb": '0',        # 당일구분 (0:전체1:당일만)
        "sdate": '',        # 시작일자
        "edate": '',        # 종료일자
        "edate": '',        # 종료일자
        "cts_date": '',     # 연속일자
        "cts_time": '',     # 연속시간
        "cts_daygb": '',    # 연속당일구분(0:연속전체1:연속당일만2:연속전일만)
        }
    response = await api.request("t4203", inputs)
    if not response: return print(f'요청실패: {api.last_message}')

    print(response)

if __name__ == "__main__":
    api = XingApi()
    run_loop(sample(api))

# Output:
'''
t4203: [00000] 정상적으로 조회가 완료되었습니다.
t4203InBlock, Fields = 10, Count = 1
+--------+-------+------+--------+------+-------+-------+----------+----------+-----------+
| shcode | gubun | ncnt | qrycnt | tdgb | sdate | edate | cts_date | cts_time | cts_daygb |
+--------+-------+------+--------+------+-------+-------+----------+----------+-----------+
|  001   |   1   | 0100 |  0100  |  0   |       |       |          |          |           |
+--------+-------+------+--------+------+-------+-------+----------+----------+-----------+
t4203OutBlock, Fields = 14, Count = 1
+--------+---------+---------+---------+---------+----------+---------+---------+---------+---------+----------+----------+-----------+-----------+
| shcode |  jisiga |  jihigh |  jilow  | jiclose | jivolume |  disiga |  dihigh |  dilow  | diclose | disvalue | cts_date |  cts_time | cts_daygb |
+--------+---------+---------+---------+---------+----------+---------+---------+---------+---------+----------+----------+-----------+-----------+
|  001   | 2475.76 | 2489.15 | 2471.79 | 2482.29 |  408790  | 2474.62 | 2488.13 | 2474.62 | 2482.34 | 2854605  | 20241017 | 122000    |     0     |
+--------+---------+---------+---------+---------+----------+---------+---------+---------+---------+----------+----------+-----------+-----------+
t4203OutBlock1, Fields = 8, Count = 100
+----------+--------+---------+---------+---------+---------+-----------+---------+
|   date   |  time  |   open  |   high  |   low   |  close  | jdiff_vol |  value  |
+----------+--------+---------+---------+---------+---------+-----------+---------+
| 20241017 | 140000 | 2610.06 |  2611.7 | 2603.52 | 2605.54 |   51880   | 1504301 |
| 20241017 | 153000 | 2605.89 | 2615.56 | 2603.95 |  2609.3 |   73008   | 2830463 |
| 20241018 | 104000 | 2616.04 | 2618.32 |  2599.2 | 2602.67 |   104688  | 3561529 |
| 20241018 | 122000 | 2602.51 | 2605.72 |  2595.2 |  2595.2 |   48290   | 1308820 |
| 20241018 | 140000 |  2595.5 | 2597.65 | 2587.96 | 2591.31 |   46812   | 1330847 |
...
| 20241120 | 122000 | 2481.33 | 2489.12 | 2478.06 | 2487.68 |   72522   | 1194103 |
| 20241120 | 140000 | 2487.67 | 2489.15 |  2481.9 | 2487.36 |   67927   | 1224051 |
| 20241120 | 153000 | 2487.34 |  2489.1 | 2481.15 | 2482.29 |   94023   | 1875346 |
| 20241121 | 104000 | 2474.62 | 2488.13 | 2474.62 | 2482.34 |   140952  | 2854605 |
+----------+--------+---------+---------+---------+---------+-----------+---------+
nRqID=16, cont_yn=True, cont_key=
+----------------------------+
|  request / elapsed times   |
+----------------------------+
| 2024-11-21 10:19:08.997685 |
|       0:00:00.044621       |
+----------------------------+
'''